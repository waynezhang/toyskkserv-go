#!/usr/bin/env bash

PORT=${1:-1179}

export COLOR_NC='\033[0m'
export COLOR_RED='\033[0;31m'
export COLOR_GREEN='\033[0;32m'

assert() {
    local message=$1
    local expected="$2"
    local actual="$3"

    if [[ "$expected" == "$actual" ]]; then
        echo -e "$COLOR_GREEN[PASS]$COLOR_NC $message: '$actual'"
    else
        echo -e "$COLOR_RED[FAIL]$COLOR_NC $message: Expected '$expected', Got '$actual'"
    fi
}

declare -a cases=()

cases+=("1smile " "1/ã‚¹ãƒã‚¤ãƒ«/ä¸€ç¬‘/å«ã¿ç¬‘ã„/ç¬‘é¡”/ğŸ˜„/")
cases+=("1ã« " "1/äºŒ/è·/ä¼¼/ç…®/å¼;ã€ŒäºŒã€ã®å¤§å­—/å¼;ã€ŒäºŒã€ã®ç•°ä½“å­—/ä¸¹/ä»;(å‘‰éŸ³ã®ä¸€)ä»ç‹/å…;å°å…/å°¼;å°¼åƒ§/é‚‡;ã¡ã‹ãƒ»ã„/è¿©;ã€Œé‚‡ã€ã®ç•°ä½“å­—/å²»;(å‘‰éŸ³)/çˆ¾;(å‘‰éŸ³)/è²³;ã€Œå¼ã€ã®æ—§å­—/è²®;ã€Œå¼ã€ã®æ—§å­—/ï¼’/2/å¼/äº/äº/äºŸ/æ¨²/æ©¤/è‰¿/è»”/å°’/å¬­/å„/å‘¢/å¦®/ç”¤/è•¤/æ¡µ/è½/ç·Œ/å’¡/æ¯¦/æ´±/æ ­/æª½/é®/ã‹¥;(ã«)/")
cases+=("1+1 " "1/ğŸ‘/")
cases+=("1=1+1 " "1/2/2=1+1/ï¼ï¼‘ï¼‹ï¼‘/")
cases+=("3 " "127.0.0.1:$PORT")
cases+=("4laug " "1/laugh/laughable/laughing/laughter/")

for i in $(seq 0 2 $(( ${#cases[@]} - 1 ))); do
  req="${cases[$i]}"
  exp="${cases[$(( $i + 1 ))]}"
  act=$(./scripts/req "$req" $PORT)
  assert $req $exp $act
done
